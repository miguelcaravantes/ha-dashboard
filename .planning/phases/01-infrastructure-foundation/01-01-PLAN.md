---
phase: 01-infrastructure-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: ['.nvmrc', 'package.json', 'yarn.lock', 'dev.js']
autonomous: true
must_haves:
  truths:
    - 'yarn.lock is removed'
    - 'dev.js is removed'
    - '.nvmrc specifies Node 22'
    - 'package.json enforces Node >=22'
  artifacts:
    - path: '.nvmrc'
      provides: 'Node version enforcement for developers'
    - path: 'package.json'
      provides: 'Node version enforcement for package manager'
  key_links: []
---

<objective>
Align the Node.js environment with modern standards and remove legacy build artifacts.

Purpose: Ensures all developers use a consistent, modern Node.js version and eliminates "split-brain" dependency management.
Output: Cleaned project root with enforced Node 22 environment.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure-foundation/01-CONTEXT.md
@.planning/phases/01-infrastructure-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enforce Node 22 Environment</name>
  <files>.nvmrc, package.json</files>
  <action>
    1. Create `.nvmrc` containing `v22`.
    2. Add `"engines": { "node": ">=22" }` to `package.json`.
  </action>
  <verify>cat .nvmrc && grep -C 5 "engines" package.json</verify>
  <done>.nvmrc exists with v22 and package.json contains engines field.</done>
</task>

<task type="auto">
  <name>Task 2: Remove Legacy Artifacts</name>
  <files>yarn.lock, dev.js</files>
  <action>
    1. Delete `yarn.lock` to standardize on `npm`.
    2. Delete `dev.js` as it is a legacy HMR shim no longer needed with modern Vite.
  </action>
  <verify>ls yarn.lock dev.js</verify>
  <done>Files yarn.lock and dev.js do not exist.</done>
</task>

<task type="auto">
  <name>Task 3: Synchronize Dependencies</name>
  <files>package-lock.json</files>
  <action>Run `npm install` to ensure `package-lock.json` is synchronized and reflects the current state without yarn.lock interference.</action>
  <verify>npm list --depth=0</verify>
  <done>package-lock.json is updated and npm install completes successfully.</done>
</task>

</tasks>

<verification>
1. Verify .nvmrc contains 'v22'.
2. Verify package.json engines field is present.
3. Verify yarn.lock and dev.js are gone.
4. Verify npm install succeeds.
</verification>

<success_criteria>
Node environment is strictly enforced and legacy artifacts are purged.
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure-foundation/01-01-SUMMARY.md`
</output>
